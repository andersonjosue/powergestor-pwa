<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, minimum-scale=0.5, user-scalable=yes" />
  <meta name="theme-color" content="#000000" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="manifest" href="/planilhas/manifest.json" />
  <link rel="apple-touch-icon" href="/icons/planilhas/apple-touch-icon.png" />
  <link rel="icon" href="/icons/planilhas/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="style.css" />
  <title>Planilhas PWA</title>
</head>
<body>
  <!-- Área invisível no canto superior direito -->
  <div id="hoverArea"></div>

  <!-- Botão flutuante -->
  <button class="menu-button" onclick="toggleMenu()">☰</button>

  <!-- Menu suspenso -->
  <div class="menu-dropdown" id="dropdownMenu">
    <a href="#" onclick="abrirAba('aba1')">Planilha de Atendimentos</a>
    <!-- <a href="#" onclick="abrirAba('aba2')">PowerChat</a> -->
    <a href="#" onclick="abrirAba('aba3')">Saídas / Demonstração</a>
    <a href="#" onclick="abrirAba('aba4')">Acessos Clientes</a>
    <a href="#" onclick="abrirAba('aba5')">Planilha Sábados</a>
    <a href="#" onclick="abrirAba('aba6')">Planilha Bloqueios</a>
  </div>

  <!-- Conteúdos das abas (mantido seu original) -->
  <div class="tab-content active" id="aba1">
    <iframe src="https://docs.google.com/spreadsheets/d/1HQr0xQ_9J-XknmXBdgLEWLzTMU7NrNRFnqLldsBoBgk/edit?gid=1852971832#gid=1852971832"></iframe>
  </div>
  <!-- <div class="tab-content" id="aba2">
    <iframe src="https://app.powerchats.com.br/"></iframe>
  </div> -->
  <div class="tab-content" id="aba3">
    <iframe src="https://docs.google.com/spreadsheets/d/1QyKqMe-dHuIXHmS5A9qhGcw5LQHYsEZzDFZV0P05Euc/edit?pli=1&gid=900920329#gid=900920329"></iframe>
  </div>
  <div class="tab-content" id="aba4">
    <iframe src="https://docs.google.com/spreadsheets/d/1ep0hFw7CdT7l7HsLQNdPLIFZ1fyRSeKZFhvmFSY-hwQ/edit?gid=0#gid=0"></iframe>
  </div>
  <div class="tab-content" id="aba5">
    <iframe src="https://docs.google.com/spreadsheets/d/1B1GufNXVUOJ8rGGxfDTrP_qQ_taZ-D0VMhgPpuSl5gA/edit?gid=1740082606#gid=1740082606"></iframe>
  </div>
  <div class="tab-content" id="aba6">
    <iframe src="https://docs.google.com/spreadsheets/d/13s2djg-M_PmL36zkRwrEGa1u1U46JULBepiFxJo_JiM/edit?gid=698920338#gid=698920338"></iframe>
  </div>

  <div class="loader" id="loader"></div>

  <script>
     const menuButton = document.querySelector('.menu-button');
    const hoverArea = document.getElementById('hoverArea');
    const menu = document.getElementById('dropdownMenu');

    function showButton() {
      menuButton.classList.add('visible');
    }

    function hideButton() {
      if (
        menu.style.display === 'none' &&
        !hoverArea.matches(':hover') &&
        !menuButton.matches(':hover')
      ) {
        menuButton.classList.remove('visible');
      }
    }

    hoverArea.addEventListener('mouseenter', showButton);
    hoverArea.addEventListener('mouseleave', () => {
      setTimeout(hideButton, 100);
    });

    menuButton.addEventListener('mouseenter', showButton);
    menuButton.addEventListener('mouseleave', () => {
      setTimeout(hideButton, 100);
    });

    function toggleMenu() {
      if (menu.style.display === 'flex') {
        menu.style.display = 'none';
        hideButton();
      } else {
        menu.style.display = 'flex';
        showButton();
      }
    }

    function abrirAba(id) {
      document.querySelectorAll('.tab-content').forEach((el) =>
        el.classList.remove('active')
      );
      document.getElementById(id).classList.add('active');
      menu.style.display = 'none';
      hideButton();
    }

    // Fecha menu se clicar fora
    window.addEventListener('click', function (e) {
      if (
        !menu.contains(e.target) &&
        !menuButton.contains(e.target) &&
        !hoverArea.contains(e.target)
      ) {
        menu.style.display = 'none';
        hideButton();
      }
    });

    // Seu código restante para iframes, service worker, loader etc permanece o mesmo
    // if ('serviceWorker' in navigator) {
    //   window.addEventListener('load', () => {
    //     navigator.serviceWorker.register('sw.js').then(reg => {
    //       setInterval(() => reg.update(), 60 * 60 * 1000);
    //     });
    //   });
    // }

    document.querySelectorAll('iframe').forEach(iframe => {
      iframe.addEventListener('load', () => {
        document.getElementById('loader').style.display = 'none';
      });
    });
  </script>
</body>
</html>
