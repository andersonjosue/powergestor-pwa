<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, minimum-scale=0.5, user-scalable=yes" />
  <meta name="theme-color" content="#000000" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="manifest" href="/planilhas/manifest.json" />
  <link rel="apple-touch-icon" href="../icons/planilha-128x128.png" />
  <link rel="stylesheet" href="style.css" />
  <title>Planilhas PWA</title>
  <style>
    body {
      height: 100vh;
      overflow: hidden;
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      background-color: #f5f5f5;
    }

    /* Seu CSS original (resumido para foco) */
    /* ... aqui coloque seu CSS original até as partes do menu */

    /* BOTÃO MENU menor e oculto */
    .menu-button {
      position: fixed;
      top: 10px;
      right: 10px;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background-color: #007bff;
      color: white;
      font-size: 20px;
      border: none;
      z-index: 1000;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    /* Botão visível */
    .menu-button.visible {
      opacity: 1;
      pointer-events: auto;
    }

    /* Área invisível para ativar o botão no canto */
    #hoverArea {
      position: fixed;
      top: 0;
      right: 0;
      width: 40px;
      height: 40px;
      z-index: 999;
      /* background: rgba(255,0,0,0.1);  Remover depois */
    }

    /* Menu Dropdown (mantido do seu CSS) */
    .menu-dropdown {
      position: fixed;
      top: 50px;
      right: 10px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 12px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      display: none;
      flex-direction: column;
      z-index: 999;
      min-width: 220px;
      overflow: hidden;
    }

    .menu-dropdown a {
      padding: 12px 16px;
      text-decoration: none;
      color: #333;
      font-weight: 500;
      border-bottom: 1px solid #eee;
      background: white;
    }

    .menu-dropdown a:hover {
      background-color: #f2f2f2;
    }

    .menu-dropdown a:last-child {
      border-bottom: none;
    }

    /* Outras partes do seu CSS... */
  </style>
</head>
<body>
  <!-- Área invisível no canto superior direito -->
  <div id="hoverArea"></div>

  <!-- Botão flutuante -->
  <button class="menu-button" onclick="toggleMenu()">☰</button>

  <!-- Menu suspenso -->
  <div class="menu-dropdown" id="dropdownMenu">
    <a href="#" onclick="abrirAba('aba1')">Planilha de Atendimentos</a>
    <!-- <a href="#" onclick="abrirAba('aba2')">PowerChat</a> -->
    <a href="#" onclick="abrirAba('aba3')">Saídas / Demonstração</a>
    <a href="#" onclick="abrirAba('aba4')">Acessos Clientes</a>
    <a href="#" onclick="abrirAba('aba5')">Planilha Sábados</a>
    <a href="#" onclick="abrirAba('aba6')">Planilha Bloqueios</a>
  </div>

  <!-- Conteúdos das abas (mantido seu original) -->
  <div class="tab-content active" id="aba1">
    <iframe src="https://docs.google.com/spreadsheets/d/1HQr0xQ_9J-XknmXBdgLEWLzTMU7NrNRFnqLldsBoBgk/edit?gid=1852971832#gid=1852971832"></iframe>
  </div>
  <!-- <div class="tab-content" id="aba2">
    <iframe src="https://app.powerchats.com.br/"></iframe>
  </div> -->
  <div class="tab-content" id="aba3">
    <iframe src="https://docs.google.com/spreadsheets/d/1QyKqMe-dHuIXHmS5A9qhGcw5LQHYsEZzDFZV0P05Euc/edit?pli=1&gid=900920329#gid=900920329"></iframe>
  </div>
  <div class="tab-content" id="aba4">
    <iframe src="https://docs.google.com/spreadsheets/d/1ep0hFw7CdT7l7HsLQNdPLIFZ1fyRSeKZFhvmFSY-hwQ/edit?gid=0#gid=0"></iframe>
  </div>
  <div class="tab-content" id="aba5">
    <iframe src="https://docs.google.com/spreadsheets/d/1B1GufNXVUOJ8rGGxfDTrP_qQ_taZ-D0VMhgPpuSl5gA/edit?gid=1740082606#gid=1740082606"></iframe>
  </div>
  <div class="tab-content" id="aba6">
    <iframe src="https://docs.google.com/spreadsheets/d/13s2djg-M_PmL36zkRwrEGa1u1U46JULBepiFxJo_JiM/edit?gid=698920338#gid=698920338"></iframe>
  </div>

  <div class="loader" id="loader"></div>

  <script>
    function toggleMenu() {
      const menu = document.getElementById("dropdownMenu");
      menu.style.display = menu.style.display === "flex" ? "none" : "flex";
    }

    function abrirAba(id) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.getElementById("dropdownMenu").style.display = "none";
    }

    // Fecha menu se clicar fora
    window.addEventListener("click", function (e) {
      const button = document.querySelector(".menu-button");
      const menu = document.getElementById("dropdownMenu");
      if (!menu.contains(e.target) && !button.contains(e.target)) {
        menu.style.display = "none";
      }
    });

    // Mostrar/ocultar botão menu ao passar mouse no canto
    const menuButton = document.querySelector('.menu-button');
    const hoverArea = document.getElementById('hoverArea');

    hoverArea.addEventListener('mouseenter', () => {
      menuButton.classList.add('visible');
    });

    hoverArea.addEventListener('mouseleave', () => {
      setTimeout(() => {
        if (!menuButton.matches(':hover')) {
          menuButton.classList.remove('visible');
        }
      }, 100);
    });

    menuButton.addEventListener('mouseleave', () => {
      setTimeout(() => {
        if (!hoverArea.matches(':hover')) {
          menuButton.classList.remove('visible');
        }
      }, 100);
    });

    // Seu código restante para iframes, service worker, loader etc permanece o mesmo
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').then(reg => {
          setInterval(() => reg.update(), 60 * 60 * 1000);
        });
      });
    }

    document.querySelectorAll('iframe').forEach(iframe => {
      iframe.addEventListener('load', () => {
        document.getElementById('loader').style.display = 'none';
      });
    });
  </script>
</body>
</html>
